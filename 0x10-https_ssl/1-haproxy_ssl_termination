global
                log /dev/log    local0
                log /dev/log    local1 notice
                chroot /var/lib/haproxy
                stats socket /run/haproxy/admin.sock mode 660 level admin expose-fd listeners
                stats timeout 30s
                user haproxy
                group haproxy
                daemon

defaults
                log             global
                mode    http
                option  httplog
                option  dontlognull
                timeout connect 5000
                timeout client  50000
                timeout server  50000

frontend www-http
                bind *:80
                http-request set-header X-Forwarded-Proto http
                default_backend servers

frontend www-https
                bind *:443 ssl crt /etc/letsencrypt/live/www.kachu.tech/fullchain.pem
                http-request set-header X-Forwarded-Proto https
                default_backend www-backend

backend servers
                balance roundrobin
                redirect scheme https if !{ssl_fc}
                server 187813-web-01 3.85.54.88:80 check
                server 187813-web-02 54.237.125.19:80 check
~                                                          
